- name: setup basic facts
  set_fact:
    uuid: bb21a88b-30e1-42b5-84e8-1d3f322de033
    az_role_definition_guid: '3e5e47e6-65f7-47ef-90b5-e5dd4d455f24'

- name: create role assignment with name
  azure_rm_roleassignment:
    scope: "/subscriptions/f64d4ee8-be94-457d-ba26-3fa6b6506cef/resourceGroups/v-xisuRG03"
    assignee_object_id: 29f40236-93d9-4e0c-a549-ce838129e9b6
    role_definition_id: "/subscriptions/f64d4ee8-be94-457d-ba26-3fa6b6506cef/providers/Microsoft.Authorization/roleDefinitions/3e5e47e6-65f7-47ef-90b5-e5dd4d455f24"
    name: "{{ uuid }}" 
  register: az_role_assignment_create

- name: delete by scope, assignee_object_id and role_definition_id
  azure_rm_roleassignment:
    scope: "/subscriptions/f64d4ee8-be94-457d-ba26-3fa6b6506cef/resourceGroups/v-xisuRG03"
    assignee_object_id: 29f40236-93d9-4e0c-a549-ce838129e9b6
    role_definition_id: "/subscriptions/f64d4ee8-be94-457d-ba26-3fa6b6506cef/providers/Microsoft.Authorization/roleDefinitions/3e5e47e6-65f7-47ef-90b5-e5dd4d455f24"
    state: absent
  register: az_role_assignment_delete
